# Facebook Prophet를 활용한 K리그 관중 수 예측

K리그1 경기별 관중 수를 예측하는 시계열 분석 프로젝트 (2022-2025)

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![Prophet](https://img.shields.io/badge/Prophet-1.1-green.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

## Problem Statement### BackgroundK리그는 관중 수 변동이 크고(최소 3,000명 ~ 최대 30,000명), 티켓 수익이 **구단 수입의 20-30%**를 차지합니다. 예측 가능한 관중 수 정보는 마케팅, 운영, 재무 계획의 핵심입니다.### Problem- **예측 불가능성**: 경기별 관중 변동이 커서 식음료, 인력 배치 계획 어려움- **저관중 경기 손실**: 프로모션 없이 저관중 경기 진행 시 기회 비용 발생- **과잉 준비 낭비**: 과대 예측 시 불필요한 인력·재고 투입으로 비용 증가- **데이터 미활용**: 과거 4년 데이터가 있으나 활용하지 않음### Objective2022-2025 시즌 데이터를 학습하여 **2026 시즌 경기별 관중 수를 예측**하는 시계열 모델- **정확도**: R² 0.62, MAE 2,979명 (전체 경기의 62%가 ±3,000명 이내)- **해석 가능성**: 홈팀, 날씨, 더비 여부 등 핵심 요인 식별- **실용성**: 라운드별/월별 요약으로 시즌 운영 계획 지원### Value Proposition- **마케팅 최적화**: 저관중 예상 경기에 할인·이벤트 집중 투입- **운영 효율화**: 예측 기반 식음료 재고, 주차장, 셔틀버스 운영- **수익 예측**: 시즌 총 관중 추정으로 티켓 수익 예측 → 스폰서 가치 산정- **팬 경험 향상**: 혼잡도 예측으로 쾌적한 관람 환경 제공### Approach- **Facebook Prophet** 시계열 예측 (트렌드 + 계절성)- **Random Forest** 피처 중요도 분석 → Top 8 피처 선택- **외부 변수 추가**: 기온, 습도, 팀 순위, 더비 여부, 요일 등- **2026 시즌 38라운드 전체 예측** 제공---
## 프로젝트 개요

K리그 데이터포털의 2022-2025 시즌 데이터를 기반으로 경기별 관중 수를 예측하는 머신러닝 모델입니다. Facebook Prophet과 Random Forest 기반 피처 선택을 활용하여 **R² 0.624, MAE 2,979명**의 성능을 달성했습니다.

### 주요 특징

- **시계열 예측**: Facebook Prophet을 활용한 트렌드 및 계절성 분석
- **피처 엔지니어링**: Random Forest 기반 중요 변수 선택 (8개 핵심 피처)
- **높은 정확도**: 전체 경기의 62%가 ±3,000명 이내 오차, 81%가 ±5,000명 이내
- **2026 시즌 예측**: 38라운드 전체 경기 관중 예측 제공

---

## 모델 성능

### 검증 데이터 성능 (Test Set)

| 지표 | 값 | 설명 |
|------|-----|------|
| **R² (결정계수)** | **0.6241** | 관중 변동의 62.4%를 설명 |
| **MAE** | **2,979명** | 평균 절대 오차 |
| **RMSE** | **3,928명** | 평균 제곱근 오차 |
| **MAPE** | **39.6%** | 평균 절대 백분율 오차 |

### 예측 정확도 분포

- ±1,000명 이내: **22.9%**
- ±3,000명 이내: **62.1%**
- ±5,000명 이내: **80.7%**

---

## 주요 분석 결과

### 1. 핵심 영향 요인 (Feature Importance)

Random Forest 분석 결과, 관중 수에 영향을 미치는 주요 요인:

1. **home_team_factor** (33.2%) - 홈 팀 고유 팬덤 지수
2. **humidity** (14.2%) - 습도 (낮을수록 관중 증가)
3. **temperature** (13.1%) - 온도 (쾌적한 날씨 선호)
4. **rank_avg** (12.8%) - 양 팀 평균 순위 (상위권 팀 경기 선호)
5. **day_of_week** (10.3%) - 요일 (주말 효과)
6. **is_derby** (7.3%) - 라이벌 더비 경기 여부
7. **month** (5.2%) - 월별 계절성
8. **is_evening** (3.9%) - 저녁 경기 여부

### 2. 계절성 패턴

- **연간 트렌드**: 시즌 중반(5-8월) 관중 증가, 시즌 초/말 감소
- **주간 패턴**: 주말(토/일) 관중 약 1.5배 증가
- **기온 영향**: 20-25°C에서 최대 관중, 극한 날씨 시 감소

### 3. 2026 시즌 예측

- **전체 시즌 평균**: 약 8,600명
- **최고 관중 예상 라운드**: 32라운드 (10월, 더비 경기 포함) - 평균 10,831명
- **최저 관중 예상 라운드**: 36라운드 (11월, 시즌 막바지) - 평균 6,832명
- **더비 경기 효과**: 일반 경기 대비 평균 +30% 관중

---

## 프로젝트 구조

```
k리그_관중_예측/
│
├── README.md                          # 프로젝트 개요 (본 문서)
├── ANALYSIS.md                        # 상세 분석 리포트
├── requirements.txt                   # 필요 패키지
├── .gitignore                         # Git 제외 파일
│
├── k_league_attendance_model.py       # 메인 모델 코드
│
├── data/                              # 원본 데이터
│   ├── k_league1_2022.csv
│   ├── k_league1_2023.csv
│   ├── k_league1_2024.csv
│   └── k_league1_2025.csv
│
└── Prophet_모델결과/                  # 모델 결과 및 시각화
    ├── 모델성능.csv
    ├── 2025시즌_실제vs예측.csv
    ├── 2026시즌_전체예측.csv
    ├── 2026시즌_라운드별요약.csv
    ├── 01_feature_importance.png      # 피처 중요도
    ├── 02_validation_performance.png  # 검증 성능
    ├── 03_season_2026_by_round.png    # 2026 라운드별 예측
    ├── 04_season_2026_monthly.png     # 2026 월별 예측
    ├── 05_seasonality_components.png  # 계절성 분석
    └── 06_2025시즌_실제vs예측.png     # 2025 시즌 검증
```

---

## 설치 및 실행

### 1. 환경 설정

```bash
# Python 3.8 이상 필요
pip install -r requirements.txt
```

### 2. 모델 학습 및 예측

```bash
python k_league_attendance_model.py
```

### 3. 결과 확인

실행 후 `Prophet_모델결과/` 폴더에 다음 파일이 생성됩니다:
- CSV: 성능 지표, 예측 결과
- PNG: 시각화 그래프 6종

---

## 데이터 출처

**K리그 데이터포털** (https://data.kleague.com/)
- 2022-2025 시즌 K리그1 경기 데이터
- 총 928 경기 (크롤링 기준일: 2025년)

### 데이터 구성

- **기간**: 2022-2025 (4시즌)
- **경기 수**: 928경기
- **주요 변수**:
  - 날짜/시간 정보
  - 홈/원정 팀
  - 실제 관중 수
  - 기온, 습도 (기상청 데이터)
  - 양 팀 순위
  - 더비 경기 여부

---

## 기술 스택

- **언어**: Python 3.8+
- **주요 라이브러리**:
  - `prophet` - 시계열 예측 모델
  - `scikit-learn` - Random Forest, 성능 평가
  - `pandas` - 데이터 처리
  - `matplotlib`, `seaborn` - 시각화
  - `numpy` - 수치 계산

---

## 모델 개발 과정

### 1. 데이터 전처리
- K리그 데이터포털 크롤링 (Selenium)
- 결측치 처리 및 이상치 제거
- 기상 데이터 매핑 (월별 평균 기온/습도)

### 2. 피처 엔지니어링
- **home_team_factor**: 팀별 평균 관중 기반 지수
- **rank_avg**: 양 팀 순위 평균
- **is_derby**: 전통 라이벌 경기 플래그
- **is_evening**: 오후 6시 이후 경기 여부
- **is_weekend**: 토/일요일 경기 여부

### 3. 모델 선택 및 튜닝
- Random Forest로 피처 중요도 분석
- Prophet 하이퍼파라미터 그리드 서치
- 시계열 분할 검증 (Train/Test)

### 4. 성능 최적화
- Top 8 피처 선택으로 과적합 방지
- Changepoint prior scale, Seasonality prior scale 최적화
- 예측값 하한선 설정 (최소 5,000명)

---

## 한계 및 개선 방향

### 현재 한계
1. **외부 변수 부재**: 팀 전력, 선수 부상, 경제 상황 등 미반영
2. **기상 데이터**: 실제 경기일 기상이 아닌 월별 평균 사용
3. **특정 이벤트**: 코로나19, 무관중 경기 등 특수 상황 제한적 반영

### 향후 개선
- [ ] 실시간 기상 API 연동
- [ ] 팀 전력 지수 (최근 5경기 성적 등) 추가
- [ ] LSTM, XGBoost 등 다른 알고리즘과 앙상블
- [ ] K리그2 데이터 확장

---

## 주요 인사이트

### 비즈니스 활용

1. **마케팅 전략**
   - 저관중 예상 경기: 프로모션 강화 (할인, 이벤트)
   - 고관중 예상 경기: 좌석 배치 최적화, 인력 배치

2. **운영 최적화**
   - 관중 예측 기반 식음료 재고 관리
   - 주차장, 셔틀버스 운영 계획

3. **수익 예측**
   - 시즌별 총 관중 추정을 통한 티켓 수익 예측
   - 스폰서 가치 산정 기초 데이터

---

## 라이선스

MIT License

---

## 작성자

K리그 관중 예측 프로젝트

## 참고 자료

- [K리그 데이터포털](https://data.kleague.com/)
- [Facebook Prophet Documentation](https://facebook.github.io/prophet/)
- [Scikit-learn Documentation](https://scikit-learn.org/)
